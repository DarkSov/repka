<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <% if (user) {%>
    <title>Welcome, <%= user.username %></title>
    <% } else { %>
    <title>Log in</title>
    <link rel="stylesheet" href="css/login.css" />
    <% } %>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2"
      crossorigin="anonymous"
    ></script>
  </head>
  <body>
    <% if (message.length>0) { %>
    <div class="alert alert-danger" role="alert"><%= message %></div>
    <% } %> <% if (user) {%>
    <div class="container">
      <div class="row justify-content-between">
        <div class="col-2">
          <h1 class="fs-3">Hi, <%= locals.currentUser.username %></h1>
        </div>
        <div class="col-2">
          <a class="text-right" href="/log-out">Log out</a>
        </div>
      </div>
    </div>

    <form action="/save-github-token" method="POST">
      <label for="githubToken">Github token</label>
      <input name="githubToken" type="password" />
      <button>Save</button>
    </form>
    <form action="/save-google-spreadsheet" id="spreadsheet-form" method="POST">
      <label for="spreadsheetId">Google spreadsheet ID</label>
      <input name="spreadsheetId" type="text" required />
      <label for="spreadsheetName">Name</label>
      <input name="spreadsheetName" type="text" required />
      <label for="nameRow">Student name row</label>
      <input name="nameRow" type="number" required />
      <div class="task-list"></div>
      <button type="submit">Save</button>
    </form>
    <button id="add-task">Add task</button>

    <select name="sheets" id="sheets-select">
      <option value="">Choose spreadsheet</option>
      <% locals.currentUser.sheets.forEach(function(sheet) { %>
      <option value="<%= sheet.id %>"><%= sheet.name %></option>
      <% }); %>
    </select>
    <div id="sheet"></div>
    <div id="student-info"></div>
    <script
      type="text/javascript"
      src="scripts/spreadsheetManagement.js"
    ></script>
    <% } else { %>

    <div class="container login">
      <h1 class="title text-center mb-5">Repka</h1>
      <div class="row justify-content-center">
        <div class="col-md-6">
          <form class="form" action="/log-in" method="POST">
            <h3 class="text-center">Log In</h3>
            <div class="form-group">
              <label for="username" class="">Username:</label><br />
              <input
                type="text"
                name="username"
                id="username"
                class="form-control"
              />
            </div>
            <div class="form-group">
              <label for="password" class="">Password:</label><br />
              <input
                type="password"
                name="password"
                id="password"
                class="form-control"
              />
            </div>
            <div class="form-group mt-3">
              <div class="d-flex justify-content-between">
                <input
                  type="submit"
                  name="submit"
                  class="btn btn-primary px-5"
                  value="Log in"
                />
                <a href="/sign-up" class="">Register here</a>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>

    <%}%>
  </body>
</html>
